{"version":3,"sources":["utils/utils.js","scripts/lobby.js"],"names":["utils","debounce","func","wait","immediate","timeout","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout","document","addEventListener","target","matches","console","log","addFriendForm","querySelector","addFriendInput","addFriendStatus","e","preventDefault","value","textContent","playerCount","playerList","myFriendList","findFriendResults","findFriendInput","localStorage","getItem","initLobby","lobbySocket","io","user","JSON","parse","email","username","on","emit","updatePeople","displayInvite","displayParty","initSearchListener","initFriendRemoveListener","initInviteListener","fetchFriends","partyList","innerHTML","map","member","join","partyInviteEl","inviter","closest","id","replace","removeFriend","dataset","friend","inviteFriend","friendToInvite","friendToRemove","currentUserID","getCurrentUserValue","fetch","method","headers","body","stringify","then","response","json","data","myFriendListHTML","debounceThreshold","trim","searchTerm","buildSearchResultList","addFriend","results","currentUserUsername","filteredResults","filter","result","findFriendResultsHTML","friendToAdd","lobbyPeople","Object","values","length","player"],"mappings":"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","file":"lobby.bf1c6fc4.js","sourceRoot":"..","sourcesContent":["const utils = {\r\n\r\n  debounce(func, wait, immediate) {\r\n    let timeout;\r\n\r\n    return function() {\r\n      const context = this, args = arguments;\r\n\r\n      const later = function() {\r\n        timeout = null;\r\n        if (!immediate) func.apply(context, args);\r\n      };\r\n\r\n      const callNow = immediate && !timeout;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(later, wait);\r\n\r\n      if (callNow) func.apply(context, args);\r\n    };\r\n  }\r\n\r\n  // getCookie(name) {\r\n  //   const nameEQ = `${name}=`;\r\n  //   const ca = document.cookie.split(';');\r\n\r\n  //   for (let i = 0; i < ca.length; i++) {\r\n  //     let c = ca[i];\r\n\r\n  //     while (c.charAt(0) === ' ') {\r\n  //       c = c.substring(1, c.length);\r\n  //     }\r\n\r\n  //     if (c.indexOf(nameEQ) === 0) {\r\n  //       return c.substring(nameEQ.length, c.length);\r\n  //     }\r\n  //   }\r\n\r\n  //   return null;\r\n  // },\r\n\r\n  // setCookie(name, value, minutes) {\r\n  //   let expirationFragment = '';\r\n\r\n  //   if (minutes) {\r\n  //     const date = new Date();\r\n  //     const ms = minutes * 60 * 1000;\r\n  //     const expiration = date.getTime() + ms;\r\n\r\n  //     date.setTime(expiration);\r\n  //     expirationFragment = `; expires=${date.toGMTString()}`;\r\n  //   }\r\n\r\n  //   document.cookie = `${name}=${value}${expirationFragment}; path=/`;\r\n  // },\r\n\r\n  // deleteCookie(name) {\r\n  //   document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`;\r\n  // }\r\n\r\n};\r\n\r\nexport default utils;","import utils from '../utils/utils.js';\r\n\r\ndocument.addEventListener('click', ({ target }) => {\r\n  \r\n  // Invite friend\r\n  if (target.matches('.invite-friend')) {\r\n    console.log('Invite friend')\r\n  }\r\n\r\n  // Remove friend\r\n  if (target.matches('.remove-friend')) {\r\n    console.log('Remove friend');\r\n  }\r\n});\r\n\r\n\r\n// Add friend form\r\nconst addFriendForm = document.querySelector('.add-friend-form');\r\nconst addFriendInput = addFriendForm.querySelector('.add-friend-input');\r\nconst addFriendStatus = addFriendForm.querySelector('.add-friend-status');\r\naddFriendForm.addEventListener('submit', e => {\r\n  e.preventDefault();\r\n  addFriendInput.value = '';\r\n  console.log('Submit add friend form');\r\n  addFriendStatus.textContent = 'Friend added!';\r\n\r\n  setTimeout(() => { addFriendStatus.textContent = ''}, 3000);\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst playerCount = document.querySelector('#player-count');\r\nconst playerList = document.querySelector('#player-list'); \r\nconst myFriendList = document.querySelector('.my-friend-list');\r\nconst findFriendResults = document.querySelector('.find-friend-results');\r\nconst findFriendInput = document.querySelector('#find-friend-input');\r\n\r\n\r\nif (localStorage.getItem('user')) {\r\n  console.log('init');\r\n  initLobby();\r\n} else { \r\n  console.log('Not logged in!');\r\n}\r\n\r\nfunction initLobby() {\r\n  const lobbySocket = io('/lobby');\r\n  const user = JSON.parse(localStorage.getItem('user'));\r\n\r\n  document.querySelector('#my-email').textContent = user.email;\r\n  document.querySelector('#my-name').textContent = user.username;\r\n\r\n  lobbySocket.on('connect', () => {\r\n    lobbySocket.emit('join', user.username);\r\n  });\r\n  \r\n  lobbySocket.on('updatePeople', updatePeople);\r\n  lobbySocket.on('inviteReceived', displayInvite);\r\n  lobbySocket.on('partyUpdated', displayParty);\r\n\r\n  initSearchListener();\r\n  initFriendRemoveListener();\r\n  initInviteListener();\r\n  fetchFriends();\r\n\r\n  function displayParty(partyList) {\r\n    document.querySelector('#party-members').innerHTML = partyList.map(member => {\r\n      return `<li>${member}</li>`;\r\n    }).join('');\r\n  }\r\n\r\n\r\n  function initInviteListener() {\r\n    const partyInviteEl = document.querySelector('#party-invite');\r\n  \r\n    partyInviteEl.addEventListener('click', e => {\r\n      const inviter = e.target.closest('div').id.replace('invite-from-', '');\r\n  \r\n      if (e.target.matches('.accept-invite')) lobbySocket.emit('acceptInvite', inviter);\r\n    });\r\n  }\r\n\r\n  function initFriendRemoveListener() {\r\n    myFriendList.addEventListener('click', e => {\r\n      if (e.target.matches('.remove-friend')) removeFriend(e.target.dataset.friend);\r\n      if (e.target.matches('.invite')) inviteFriend(e.target.dataset.friend);\r\n    });\r\n  }\r\n\r\n\r\n\r\n  function inviteFriend(friendToInvite) {\r\n    console.log(friendToInvite);\r\n    lobbySocket.emit('inviteFriend', friendToInvite);\r\n  }\r\n  \r\n  function removeFriend(friendToRemove) {\r\n    const currentUserID = getCurrentUserValue('id');\r\n    if (!currentUserID) return;\r\n     \r\n    fetch('/api/remove-friend', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ currentUserID, friendToRemove })\r\n    })\r\n    .then(response => response.json())\r\n    .then(data => {\r\n      console.log('/api/remove-friend: \\n', data);\r\n      fetchFriends();\r\n    });\r\n  }\r\n}\r\n\r\nfunction fetchFriends() {\r\n  const currentUserID = getCurrentUserValue('id');\r\n\r\n  fetch('/api/fetch-friends', {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ currentUserID })\r\n  })\r\n  .then(response =>response.json())\r\n  .then(data => {\r\n    console.log('/api/fetch-friends: \\n', data);\r\n    const myFriendListHTML = data.map(friend => {\r\n      return `<li class=\"friend\">\r\n        <span>${friend}</span>\r\n        <button class=\"invite\" data-friend=\"${friend}\">Invite To Party</button>\r\n        <button class=\"remove-friend\" data-friend=\"${friend}\">Remove Friend</button>\r\n      </li>`;\r\n    }).join(''); \r\n\r\n    myFriendList.innerHTML = myFriendListHTML;\r\n  });\r\n}\r\n\r\nfunction initSearchListener() {\r\n  const debounceThreshold = 100;\r\n\r\n  findFriendInput.addEventListener('keyup', utils.debounce(e => {\r\n    const { value } = e.target;\r\n\r\n    if (value.trim() === '') return findFriendResults.innerHTML = '';\r\n\r\n    fetch('/api/find-friend', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ searchTerm: value })\r\n    })\r\n    .then(response => response.json())\r\n    .then(data => {\r\n      console.log('/api/find-friend: \\n', data);\r\n      buildSearchResultList(data);\r\n    });\r\n\r\n  }, debounceThreshold));\r\n\r\n  findFriendResults.addEventListener('click', e => {\r\n    if (e.target.matches('.add-friend')) addFriend(e.target.dataset.friend);\r\n  });\r\n}\r\n\r\nfunction buildSearchResultList(results) {\r\n  const currentUserUsername = getCurrentUserValue('username');\r\n  const filteredResults = results.filter(result => {\r\n    return result !== currentUserUsername;\r\n  });\r\n\r\n  let findFriendResultsHTML = filteredResults.map(friend => {\r\n    return `<li class=\"friend-item\">\r\n      <span>${friend}</span>\r\n      <button class=\"add-friend\" data-friend=\"${friend}\">Add Friend</button>\r\n    </li>`;\r\n  }).join('');\r\n  \r\n  if (!findFriendResultsHTML) findFriendResultsHTML = '<li>No results found</li>';\r\n  findFriendResults.innerHTML = findFriendResultsHTML;\r\n}\r\n\r\nfunction addFriend(friendToAdd) {\r\n\r\n  const currentUserID = getCurrentUserValue('id');\r\n  if (!currentUserID) return;\r\n   \r\n  fetch('/api/add-friend', {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ currentUserID, friendToAdd })\r\n  })\r\n  .then(response => response.json())\r\n  .then(data => {\r\n    console.log('/api/add-friend: \\n', data);\r\n    fetchFriends();\r\n  });\r\n}\r\n\r\n\r\nfunction updatePeople(lobbyPeople) {\r\n  playerCount.textContent = Object.values(lobbyPeople).length;\r\n  playerList.innerHTML = Object.values(lobbyPeople).map(player => {\r\n    return `<li>\r\n      <span class=\"player\">${player.username}</span>\r\n    </li>`;\r\n  }).join('');\r\n}\r\n\r\n\r\nfunction getCurrentUserValue(value) {\r\n  return JSON.parse(localStorage.getItem('user') || '{}')[value];\r\n}\r\n\r\nfunction displayInvite(inviter) {\r\n  const partyInviteEl = document.querySelector('#party-invite');\r\n  // TODO: Add deduplication of invite - or flash existing one\r\n\r\n  partyInviteEl.innerHTML += `<div id=\"invite-from-${inviter}\">\r\n      <span class=\"invitation\"> ${inviter} would like to invite you to their party</span>\r\n      <button class=\"accept-invite\">Accept</button>\r\n      <button>Decline</button>\r\n    </div>\r\n  `;\r\n}\r\n\r\n\r\n\r\n"]}